# Device Inventory Collection Script

## Purpose
This script automates the collection of hardware and identity information from **Active Directory domain-joined computers**.
It is intended to simulate enterprise device inventory and asset tracking workflows in a Windows environment.

---

## Script Overview
- Queries Active Directory for all domain-joined computers
- Collects hardware and identity data remotely using CIM
- Identifies online and offline systems
- Exports results to a centralized CSV file

---

## Evidence

### 1. PowerShell Device Inventory Script

<img
  src="https://github.com/user-attachments/assets/1765fb74-b659-4df5-a7c2-47defa40d011"
  alt="PowerShell device inventory collection script"
  width="600"
/>

*PowerShell script used to collect hardware and identity information from domain-joined computers by querying Active Directory and remotely accessing systems via CIM.*

---

### 2. Device Inventory CSV Output

<img
  src="https://github.com/user-attachments/assets/f926677d-f166-4382-aa41-6295e9e5bb49"
  alt="CSV output generated by device inventory script"
  width="600"
/>

*CSV output generated by the device inventory script, showing online and offline domain systems along with key hardware identifiers.*

---

## Device Inventory Collection Script

```powershell
Import-Module ActiveDirectory

$OutputPath = "C:\ad-lab-scripts\device-collection\domain-device-inventory.csv"

$Computers = Get-ADComputer -Filter * | Select-Object -ExpandProperty Name

$Inventory = foreach ($Computer in $Computers) {

    try {
        $ComputerSystem = Get-CimInstance Win32_ComputerSystem -ComputerName $Computer -ErrorAction Stop
        $BIOS = Get-CimInstance Win32_BIOS -ComputerName $Computer
        $SystemProduct = Get-CimInstance Win32_ComputerSystemProduct -ComputerName $Computer

        [PSCustomObject]@{
            ComputerName  = $Computer
            Domain        = $ComputerSystem.Domain
            LoggedOnUser  = $ComputerSystem.UserName
            Manufacturer = $ComputerSystem.Manufacturer
            Model         = $ComputerSystem.Model
            SerialNumber  = $BIOS.SerialNumber
            BIOSUUID      = $SystemProduct.UUID
            Status        = "Online"
        }
    }
    catch {
        [PSCustomObject]@{
            ComputerName  = $Computer
            Domain        = "N/A"
            LoggedOnUser  = "N/A"
            Manufacturer = "N/A"
            Model         = "N/A"
            SerialNumber  = "N/A"
            BIOSUUID      = "N/A"
            Status        = "Offline or Unreachable"
        }
    }
}

$Inventory | Export-Csv -Path $OutputPath -NoTypeInformation
```
## Script Behavior
- Retrieves all computer objects from Active Directory
- Collects system name, domain, logged-on user, manufacturer, model, and serial numbers
- Uses error handling to flag offline or unreachable devices
- Exports all results to a CSV file for reporting and auditing
